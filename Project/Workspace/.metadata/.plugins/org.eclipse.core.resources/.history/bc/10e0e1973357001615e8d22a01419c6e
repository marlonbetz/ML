import numpy as np 
from keras.models import Model
from keras.layers import GRU,Dense,Input,Merge,Embedding





"""
MODEL
"""
maxlen = 10
n_symbols = 1000
dim_embedding_phono = 10
dim_embedding_word = 10
dim_embedding_language = 10
dim_embedding_info = 10
n_languages  =100
n_info = 1000

#input phono
input_phono = Input((maxlen,n_symbols))
embedded_phoneme = Embedding(n_symbols, dim_embedding_phono, input_length=maxlen)(input_phono)
embedded_word = GRU(output_dim=dim_embedding_word, input_shape=(maxlen, len(n_symbols)))(embedded_phoneme)

#input language
input_language = Input((n_languages,))
embedded_language = Dense(dim_embedding_language,activation="linear")(input_phono)

#input info
input_info = Input((1000,))
embedded_info = Dense(dim_embedding_info,activation="linear")(input_phono)

#concatenate everything
concat = Merge([embedded_word,embedded_language,embedded_info],mode="concat")

#fully connected layer
concat = Dense(1000,activation="relu")(concat)

#classifier
y_predicted = Dense(n_symbols,activation="softmax")(concat)

model = Model([input_phono,input_language,input_info],y_predicted)
model.compile("Adam","categorical_crossentropy")




